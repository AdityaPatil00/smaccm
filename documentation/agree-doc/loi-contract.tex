\begin{figure}

\noindent\fbox{%
    \parbox{\textwidth}{%

{\color{color18} \textbf{eq}} loi {\color{color18} \textbf{:}} {\color{color18} \textbf{int;}}

{\color{color18} \textbf{eq}} auth\_in {\color{color18} \textbf{:}} ULB\_Device\_Types{\color{color18} \textbf{::}}STANAG\_4586\_message{\color{color18} \textbf{.}}cucs\_auth\_req 
  

{\color{color18} \textbf{=}} outside\_stanag\_in{\color{color18} \textbf{.}}m\_data{\color{color18} \textbf{.}}cucs\_auth\_req{\color{color18} \textbf{;}} 

{\color{color18} \textbf{eq}} id\_in\_control {\color{color18} \textbf{:}} {\color{color18} \textbf{int;}} 

{\color{color18} \textbf{eq}} override\_control {\color{color18} \textbf{:}} {\color{color18} \textbf{bool;}}

{\color{color18} \textbf{eq}} none\_in\_control {\color{color18} \textbf{:}} {\color{color18} \textbf{bool;}} 

{\color{color18} \textbf{eq}} control\_station {\color{color18} \textbf{:}} {\color{color18} \textbf{int;}}

{\color{color17} -{}-in the actual implementation this should be ascertained}

{\color{color17} -{}-by checking to see if the CUCS is in the auth\_map with}

{\color{color17} -{}-a specified loi}

{\color{color18} \textbf{eq}} is\_auth\_loi {\color{color18} \textbf{:}} {\color{color18} \textbf{bool;}}

\vspace{12pt}
{\color{color18} \textbf{eq}} mid {\color{color18} \textbf{:}} {\color{color18} \textbf{int}} 
{\color{color18} \textbf{=}} outside\_stanag\_in{\color{color18} \textbf{.}}m\_id{\color{color18} \textbf{;}}

\vspace{12pt}
{\color{color18} \textbf{eq}} loi2 {\color{color18} \textbf{:}} {\color{color18} \textbf{bool}} 
{\color{color18} \textbf{=}} loi {\color{color18} \textbf{=}} 2{\color{color18} \textbf{;}}

{\color{color18} \textbf{eq}} loi3 {\color{color18} \textbf{:}} {\color{color18} \textbf{bool}} 
{\color{color18} \textbf{=}} loi {\color{color18} \textbf{=}} 3{\color{color18} \textbf{;}}

{\color{color18} \textbf{eq}} loi45 {\color{color18} \textbf{:}} {\color{color18} \textbf{bool}} 
{\color{color18} \textbf{=}} loi {\color{color18} \textbf{=}} 4 {\color{color18} \textbf{or}} 
loi {\color{color18} \textbf{=}} 5{\color{color18} \textbf{;  }}

}%
}
\caption{Part 1 of the contract for the LOI Manager}
\label{fig:loi-contract1}
\end{figure}


\begin{figure}
\vspace{-40pt}

\noindent\fbox{%
    \parbox{\textwidth}{%

{\color{color18} \textbf{eq}} loi\_approved\_for\_message {\color{color18} \textbf{:}} 
{\color{color18} \textbf{bool  }}
 {\color{color18} \textbf{=}} 
{\color{color18} \textbf{(  }}

{\color{color18} \textbf{if(}}mid {\color{color18} \textbf{=}} 1{\color{color18} \textbf{)}} 
{\color{color18} \textbf{then}} {\color{color17} -{}-note that this is an auth request, 
so we don't route it    }

{\color{color18} \textbf{false  }}

{\color{color18} \textbf{else}} {\color{color18} \textbf{if(}}mid {\color{color18} \textbf{=}} 
20 {\color{color18} \textbf{or}} mid {\color{color18} \textbf{=}} 21{\color{color18} \textbf{)}} 
{\color{color18} \textbf{then    }}

\parindent=14pt
loi2 {\color{color18} \textbf{or}} loi3 {\color{color18} \textbf{or}} loi45  

\parindent=0pt
{\color{color18} \textbf{else}} {\color{color18} \textbf{if(}}40 {\color{color18} \textbf{\texttt{<}=}} 
mid {\color{color18} \textbf{and}} mid {\color{color18} \textbf{\texttt{<}=}} 46{\color{color18} \textbf{)}} 
{\color{color18} \textbf{then    }}

\parindent=14pt
loi45  

\parindent=0pt
{\color{color18} \textbf{else}} {\color{color18} \textbf{if(}}mid {\color{color18} \textbf{=}} 
47{\color{color18} \textbf{)}} {\color{color18} \textbf{then    }}

\parindent=14pt
loi3 {\color{color18} \textbf{or}} loi45  

\parindent=0pt
{\color{color18} \textbf{else}} {\color{color18} \textbf{if(}}mid {\color{color18} \textbf{=}} 
100{\color{color18} \textbf{)}} {\color{color18} \textbf{then    }}

\parindent=14pt
loi45  

\parindent=0pt
{\color{color18} \textbf{else}} {\color{color18} \textbf{if(}}mid {\color{color18} \textbf{=}} 
101{\color{color18} \textbf{)}} {\color{color18} \textbf{then    }}

\parindent=14pt
loi2 {\color{color18} \textbf{or}} loi3 {\color{color18} \textbf{or}} loi45  

\parindent=0pt
{\color{color18} \textbf{else}} {\color{color18} \textbf{if(}}102 {\color{color18} \textbf{\texttt{<}=}} 
mid {\color{color18} \textbf{and}} mid {\color{color18} \textbf{\texttt{<}=}} 108{\color{color18} \textbf{)}} 
{\color{color18} \textbf{then    }}

\parindent=14pt
loi45  

\parindent=0pt
{\color{color18} \textbf{else}} {\color{color18} \textbf{if(}}200 {\color{color18} \textbf{\texttt{<}=}} 
mid {\color{color18} \textbf{and}} mid {\color{color18} \textbf{\texttt{<}=}} 206{\color{color18} \textbf{)}} 
{\color{color18} \textbf{then    }}

\parindent=14pt
loi3  

\parindent=0pt
{\color{color18} \textbf{else}} {\color{color18} \textbf{if(}}mid {\color{color18} \textbf{=}} 
207{\color{color18} \textbf{)}} {\color{color18} \textbf{then    }}

\parindent=14pt
loi3 {\color{color18} \textbf{or}} loi45  

\parindent=0pt
{\color{color18} \textbf{else}} {\color{color18} \textbf{if(}}300 {\color{color18} \textbf{\texttt{<}=}} 
mid {\color{color18} \textbf{and}} mid {\color{color18} \textbf{\texttt{<}=}} 306{\color{color18} \textbf{)}} 
{\color{color18} \textbf{then    }}

\parindent=14pt
loi2 {\color{color18} \textbf{or}} loi3  

\parindent=0pt
{\color{color18} \textbf{else}} {\color{color18} \textbf{if(}}mid {\color{color18} \textbf{=}} 
307 {\color{color18} \textbf{or}} mid {\color{color18} \textbf{=}} 308{\color{color18} \textbf{)}} 
{\color{color18} \textbf{then    }}

\parindent=14pt
loi3  

\parindent=0pt
{\color{color18} \textbf{else}} {\color{color18} \textbf{if(}}400 {\color{color18} \textbf{\texttt{<}=}} 
mid {\color{color18} \textbf{and}} mid {\color{color18} \textbf{\texttt{<}=}} 404{\color{color18} \textbf{)}} 
{\color{color18} \textbf{then    }}

\parindent=14pt
loi2 {\color{color18} \textbf{or}} loi3 {\color{color18} \textbf{or}} loi45  

\parindent=0pt
{\color{color18} \textbf{else}} {\color{color18} \textbf{if(}}500 {\color{color18} \textbf{\texttt{<}=}} 
mid {\color{color18} \textbf{and}} mid {\color{color18} \textbf{\texttt{<}=}} 503{\color{color18} \textbf{)}} 
{\color{color18} \textbf{then    }}

\parindent=14pt
loi2 {\color{color18} \textbf{or}} loi3 {\color{color18} \textbf{or}} loi45  

\parindent=0pt
{\color{color18} \textbf{else}} {\color{color18} \textbf{if(}}mid {\color{color18} \textbf{=}} 
600{\color{color18} \textbf{)}} {\color{color18} \textbf{then    }}

\parindent=14pt
loi3 {\color{color18} \textbf{or}} loi45  

\parindent=0pt
{\color{color18} \textbf{else}} {\color{color18} \textbf{if(}}mid {\color{color18} \textbf{=}} 
700{\color{color18} \textbf{)}} {\color{color18} \textbf{then    }}

\parindent=14pt
loi3 {\color{color18} \textbf{or}} loi45  

\parindent=0pt
{\color{color18} \textbf{else}} {\color{color18} \textbf{if(}}mid {\color{color18} \textbf{=}} 
800{\color{color18} \textbf{)}} {\color{color18} \textbf{then    }}

\parindent=14pt
loi45  

\parindent=0pt
{\color{color18} \textbf{else}} {\color{color18} \textbf{if(}}801 {\color{color18} \textbf{\texttt{<}=}} 
mid {\color{color18} \textbf{and}} mid {\color{color18} \textbf{\texttt{<}=}} 803{\color{color18} \textbf{)}} 
{\color{color18} \textbf{then    }}

\parindent=14pt
loi3 {\color{color18} \textbf{or}} loi45  

\parindent=0pt
{\color{color18} \textbf{else}} {\color{color18} \textbf{if(}}mid {\color{color18} \textbf{=}} 
804{\color{color18} \textbf{)}} {\color{color18} \textbf{then    }}

\parindent=14pt
loi3  

\parindent=0pt
{\color{color18} \textbf{else}} {\color{color18} \textbf{if(}}mid {\color{color18} \textbf{=}} 
805 {\color{color18} \textbf{or}} mid {\color{color18} \textbf{=}} 806{\color{color18} \textbf{)}} 
{\color{color18} \textbf{then}}     

\parindent=14pt
loi3 {\color{color18} \textbf{or}} loi45  

\parindent=0pt
{\color{color18} \textbf{else}} {\color{color18} \textbf{if(}}mid {\color{color18} \textbf{=}} 
900{\color{color18} \textbf{)}} {\color{color18} \textbf{then    }}

\parindent=14pt
loi3 {\color{color18} \textbf{or}} loi45  

\parindent=0pt
{\color{color18} \textbf{else}} {\color{color18} \textbf{if(}}mid {\color{color18} \textbf{=}} 
1000 {\color{color18} \textbf{or}} mid {\color{color18} \textbf{=}} 1001{\color{color18} \textbf{)}} 
{\color{color18} \textbf{then    }}

\parindent=14pt
loi3 {\color{color18} \textbf{or}} loi45  

\parindent=0pt
{\color{color18} \textbf{else}} {\color{color18} \textbf{if(}}mid {\color{color18} \textbf{=}} 
1100 {\color{color18} \textbf{or}} mid {\color{color18} \textbf{=}} 1101{\color{color18} \textbf{)}} 
{\color{color18} \textbf{then    }}

\parindent=14pt
loi3 {\color{color18} \textbf{or}} loi45  

\parindent=0pt
{\color{color18} \textbf{else}} {\color{color18} \textbf{if(}}1200 {\color{color18} \textbf{\texttt{<}=}} 
mid {\color{color18} \textbf{and}} mid {\color{color18} \textbf{\texttt{<}=}} 1203{\color{color18} \textbf{)}} 
{\color{color18} \textbf{then}}     

\parindent=14pt
loi2 {\color{color18} \textbf{or}} loi3 {\color{color18} \textbf{or}} loi45  

\parindent=0pt
{\color{color18} \textbf{else}} {\color{color18} \textbf{if(}}1300 {\color{color18} \textbf{\texttt{<}=}} 
mid {\color{color18} \textbf{and}} mid {\color{color18} \textbf{\texttt{<}=}} 1303{\color{color18} \textbf{)}} 
{\color{color18} \textbf{then    }}

\parindent=14pt
loi2 {\color{color18} \textbf{or}} loi3 {\color{color18} \textbf{or}} loi45  

\parindent=0pt
{\color{color18} \textbf{else}} {\color{color18} \textbf{if(}}1400 {\color{color18} \textbf{\texttt{<}=}} 
mid {\color{color18} \textbf{and}} mid {\color{color18} \textbf{\texttt{<}=}} 1402{\color{color18} \textbf{)}} 
{\color{color18} \textbf{then    }}

\parindent=14pt
loi2 {\color{color18} \textbf{or}} loi3 {\color{color18} \textbf{or}} loi45  

\parindent=0pt
{\color{color18} \textbf{else}} {\color{color18} \textbf{if(}}mid {\color{color18} \textbf{=}} 
1403{\color{color18} \textbf{)}} {\color{color18} \textbf{then    }}

\parindent=10pt
loi3 {\color{color18} \textbf{or}} loi45  

\parindent=0pt
{\color{color18} \textbf{else}} {\color{color18} \textbf{if(}}mid {\color{color18} \textbf{=}} 
1500 {\color{color18} \textbf{or}} mid {\color{color18} \textbf{=}} 1501{\color{color18} \textbf{)}} 
{\color{color18} \textbf{then    }}

\parindent=14pt
loi45  

\parindent=0pt
{\color{color18} \textbf{else}} {\color{color18} \textbf{if(}}mid {\color{color18} \textbf{=}} 
1600{\color{color18} \textbf{)}} {\color{color18} \textbf{then    }}

\parindent=14pt
loi45  

\parindent=0pt
{\color{color18} \textbf{else}}     

{\color{color18} \textbf{false);         }}

}%
}
\caption{Part 2 of the contract for the LOI Manager}
\label{fig:loi-contract2}
\end{figure}

\begin{figure}

\noindent\fbox{%
    \parbox{\textwidth}{%
{\color{color18} \textbf{eq}} initial\_state {\color{color18} \textbf{:}} {\color{color18} \textbf{bool}} 
{\color{color18} \textbf{=}}     

\parindent=7pt
loi {\color{color18} \textbf{=}} 0 {\color{color18} \textbf{and  }}

override\_control {\color{color18} \textbf{=}} {\color{color18} \textbf{false}} 
{\color{color18} \textbf{and  }}

none\_in\_control {\color{color18} \textbf{=}} {\color{color18} \textbf{true}} 
{\color{color18} \textbf{and  }}

control\_station {\color{color18} \textbf{=}} 0{\color{color18} \textbf{;}}    
 

\vspace{12pt}
\parindent=0pt
{\color{color18} \textbf{initially:   }}

{\color{color18} \textbf{not}} {\color{color18} \textbf{event(}}wescam\_vsm\_stanag\_out{\color{color18} \textbf{)}} 
{\color{color18} \textbf{and   }}

{\color{color18} \textbf{not}} {\color{color18} \textbf{event(}}vsm\_stanag\_out{\color{color18} \textbf{); 
  }}

\vspace{12pt}
{\color{color18} \textbf{initially:   }}

\parindent=3pt
initial\_state{\color{color18} \textbf{; }}

\vspace{12pt}
\parindent=0pt
{\color{color18} \textbf{guarantee}} {\color{color19} \texttt{"}No message recieved 
behavior\texttt{"}}{\color{color18} \textbf{:}}   

{\color{color17} -{}-keep this up to date as new message types are implemented  }

{\color{color18} \textbf{(not}} {\color{color18} \textbf{event(}}outside\_stanag\_in{\color{color18} \textbf{)}} 
{\color{color18} \textbf{or}} outside\_stanag\_in{\color{color18} \textbf{.}}m\_id 
{\color{color18} \textbf{!=}} 1{\color{color18} \textbf{)}} {\color{color18} \textbf{=\texttt{>}}} 
{\color{color18} \textbf{(  }}

\parindent=25pt
initial\_state {\color{color18} \textbf{-\texttt{>}}}    

loi {\color{color18} \textbf{=}} {\color{color18} \textbf{pre(}}loi{\color{color18} \textbf{)}} 
{\color{color18} \textbf{and  }}

override\_control {\color{color18} \textbf{=}} {\color{color18} \textbf{pre(}}override\_control{\color{color18} \textbf{)}} 
{\color{color18} \textbf{and  }}

id\_in\_control {\color{color18} \textbf{=}} {\color{color18} \textbf{pre(}}id\_in\_control{\color{color18} \textbf{)}} 
{\color{color18} \textbf{and  }}

none\_in\_control {\color{color18} \textbf{=}} {\color{color18} \textbf{pre(}}none\_in\_control{\color{color18} \textbf{)}} 
{\color{color18} \textbf{and}}   

control\_station {\color{color18} \textbf{=}} {\color{color18} \textbf{pre(}}control\_station{\color{color18} \textbf{) 
 }}

\parindent=0pt
{\color{color18} \textbf{);      }}

}%
}
\caption{Part 3 of the contract for the LOI Manager}
\label{fig:loi-contract3}
\end{figure}

\begin{figure}

\noindent\fbox{%
    \parbox{\textwidth}{%

{\color{color18} \textbf{guarantee}} {\color{color19} \texttt{"}CUCS Authorisation 
Requestion Behavior\texttt{"}} {\color{color18} \textbf{:  }}

{\color{color18} \textbf{event(}}outside\_stanag\_in{\color{color18} \textbf{)}} 
{\color{color18} \textbf{and}} outside\_stanag\_in{\color{color18} \textbf{.}}m\_id 
{\color{color18} \textbf{=}} 1 {\color{color18} \textbf{=\texttt{>}}} {\color{color18} \textbf{( 
   }}

{\color{color17} -{}-auth request is message \#1    }

{\color{color18} \textbf{if(}}auth\_in{\color{color18} \textbf{.}}csm {\color{color18} \textbf{=}} 
0
{\color{color18} \textbf{and}} 
auth\_in{\color{color18} \textbf{.}}cucsid {\color{color18} \textbf{=}} 
id\_in\_control
{\color{color18}\textbf{)}} {\color{color18} \textbf{then}} \\{\color{color17} 
-{}-relenquish control      }

\parindent=21pt
override\_control {\color{color18} \textbf{=}} {\color{color18} \textbf{false}} 
{\color{color18} \textbf{and      }}

none\_in\_control {\color{color18} \textbf{=}} {\color{color18} \textbf{true}} 
{\color{color18} \textbf{and      }}

loi {\color{color18} \textbf{=}} 0    

\parindent=0pt
{\color{color18} \textbf{else}} {\color{color18} \textbf{if}} {\color{color18} \textbf{((}}auth\_in{\color{color18} \textbf{.}}csm 
{\color{color18} \textbf{=}} 1 {\color{color18} \textbf{or}} auth\_in{\color{color18} \textbf{.}}csm 
{\color{color18} \textbf{=}} 2{\color{color18} \textbf{)}} {\color{color18} \textbf{and}} 
             

{\color{color18} \textbf{prev(}}loi {\color{color18} \textbf{=}} 3{\color{color18} \textbf{,true)}} 
{\color{color18} \textbf{and}}              

auth\_in{\color{color18} \textbf{.}}rloi {\color{color18} \textbf{\texttt{>}}} 
3{\color{color18} \textbf{)}} {\color{color18} \textbf{then}} {\color{color17} -{}-request 
control w/ greater loi      }

\parindent=21pt
override\_control {\color{color18} \textbf{=}} {\color{color18} \textbf{(}}auth\_in{\color{color18} \textbf{.}}csm 
{\color{color18} \textbf{=}} 2{\color{color18} \textbf{)}} {\color{color18} \textbf{and 
     }}

id\_in\_control {\color{color18} \textbf{=}} auth\_in{\color{color18} \textbf{.}}cucsid 
{\color{color18} \textbf{and      }}

none\_in\_control {\color{color18} \textbf{=}} {\color{color18} \textbf{false}} 
{\color{color18} \textbf{and      }}

control\_station {\color{color18} \textbf{=}} auth\_in{\color{color18} \textbf{.}}cs 
{\color{color18} \textbf{and      }}

loi {\color{color18} \textbf{=}} auth\_in{\color{color18} \textbf{.}}rloi    

\parindent=0pt
{\color{color18} \textbf{else}} {\color{color18} \textbf{if(}}auth\_in{\color{color18} \textbf{.}}csm 
{\color{color18} \textbf{=}} 1 {\color{color18} \textbf{and}} {\color{color18} \textbf{not}} 
{\color{color18} \textbf{prev(}}override\_control{\color{color18} \textbf{,false))}} 
{\color{color18} \textbf{then}}       

{\color{color17} -{}-request control      }

\parindent=21pt
override\_control {\color{color18} \textbf{=}} {\color{color18} \textbf{false}} 
{\color{color18} \textbf{and      }}

id\_in\_control {\color{color18} \textbf{=}} auth\_in{\color{color18} \textbf{.}}cucsid 
{\color{color18} \textbf{and      }}

none\_in\_control {\color{color18} \textbf{=}} {\color{color18} \textbf{false}} 
{\color{color18} \textbf{and      }}

control\_station {\color{color18} \textbf{=}} auth\_in{\color{color18} \textbf{.}}cs 
{\color{color18} \textbf{and      }}

loi {\color{color18} \textbf{=}} auth\_in{\color{color18} \textbf{.}}rloi    

\parindent=0pt
{\color{color18} \textbf{else}} {\color{color18} \textbf{if(}}auth\_in{\color{color18} \textbf{.}}csm 
{\color{color18} \textbf{=}} 2 {\color{color18} \textbf{and}} {\color{color18} \textbf{not}} 
{\color{color18} \textbf{prev(}}override\_control{\color{color18} \textbf{,false))}} 
{\color{color18} \textbf{then}}       

{\color{color17} -{}-override control      }

\parindent=21pt
override\_control {\color{color18} \textbf{=}} {\color{color18} \textbf{true}} 
{\color{color18} \textbf{and      }}

id\_in\_control {\color{color18} \textbf{=}} auth\_in{\color{color18} \textbf{.}}cucsid 
{\color{color18} \textbf{and      }}

none\_in\_control {\color{color18} \textbf{=}} {\color{color18} \textbf{false}} 
{\color{color18} \textbf{and      }}

control\_station {\color{color18} \textbf{=}} auth\_in{\color{color18} \textbf{.}}cs 
{\color{color18} \textbf{and      }}

loi {\color{color18} \textbf{=}} auth\_in{\color{color18} \textbf{.}}rloi    

\parindent=0pt
{\color{color18} \textbf{else      }}

\parindent=21pt
initial\_state {\color{color18} \textbf{-\texttt{>}      }}

override\_control {\color{color18} \textbf{=}} {\color{color18} \textbf{pre(}}override\_control{\color{color18} \textbf{)}} 
{\color{color18} \textbf{and      }}

id\_in\_control {\color{color18} \textbf{=}} {\color{color18} \textbf{pre(}}id\_in\_control{\color{color18} \textbf{)}} 
{\color{color18} \textbf{and      }}

none\_in\_control {\color{color18} \textbf{=}} {\color{color18} \textbf{pre(}}none\_in\_control{\color{color18} \textbf{)}} 
{\color{color18} \textbf{and      }}

loi {\color{color18} \textbf{=}} {\color{color18} \textbf{pre(}}loi{\color{color18} \textbf{)}} 
{\color{color18} \textbf{and      }}

\parindent=7pt
control\_station {\color{color18} \textbf{=}} {\color{color18} \textbf{pre(}}control\_station{\color{color18} \textbf{) 
     }}

\parindent=0pt
{\color{color18} \textbf{);      }}

}%
}
\caption{Part 4 of the contract for the LOI Manager}
\label{fig:loi-contract4}
\end{figure}

\begin{figure}

\noindent\fbox{%
    \parbox{\textwidth}{%

{\color{color18} \textbf{guarantee}} {\color{color19} \texttt{"}message routing\texttt{"}} 
{\color{color18} \textbf{:   }}

{\color{color18} \textbf{if(event(}}outside\_stanag\_in{\color{color18} \textbf{)}} 
{\color{color18} \textbf{and}} loi\_approved\_for\_message{\color{color18} \textbf{)}} 
{\color{color18} \textbf{then}}      

{\color{color18} \textbf{if(}}control\_station {\color{color18} \textbf{=}} 1 {\color{color18} \textbf{and}} 
loi {\color{color18} \textbf{=}} 3{\color{color18} \textbf{)}} {\color{color18} \textbf{then 
      }}

\parindent=10pt
wescam\_vsm\_stanag\_out {\color{color18} \textbf{=}} outside\_stanag\_in {\color{color18} \textbf{and 
      }}

{\color{color18} \textbf{event(}}wescam\_vsm\_stanag\_out{\color{color18} \textbf{)}} 
{\color{color18} \textbf{and       }}

{\color{color18} \textbf{not}} {\color{color18} \textbf{event(}}vsm\_stanag\_out{\color{color18} \textbf{) 
    }}

\parindent=0pt
{\color{color18} \textbf{else       }}

\parindent=10pt
vsm\_stanag\_out {\color{color18} \textbf{=}} outside\_stanag\_in {\color{color18} \textbf{and 
      }}

{\color{color18} \textbf{not}} {\color{color18} \textbf{event(}}wescam\_vsm\_stanag\_out{\color{color18} \textbf{)}} 
{\color{color18} \textbf{and       }}

{\color{color18} \textbf{event(}}vsm\_stanag\_out{\color{color18} \textbf{)   }}

\parindent=0pt

{\color{color18} \textbf{else      }}
\parindent=10pt

{\color{color18} \textbf{not}} {\color{color18} \textbf{event(}}wescam\_vsm\_stanag\_out{\color{color18} \textbf{)}} 
{\color{color18} \textbf{and      }}

{\color{color18} \textbf{not}} {\color{color18} \textbf{event(}}vsm\_stanag\_out{\color{color18} \textbf{); 
           }}

\vspace{12pt}
\parindent=0pt

{\color{color18} \textbf{assume}} {\color{color19} \texttt{"}valid auth data\texttt{"}} 
{\color{color18} \textbf{:   }}
\parindent=10pt

{\color{color18} \textbf{event(}}outside\_stanag\_in{\color{color18} \textbf{)}} 
{\color{color18} \textbf{=\texttt{>}     }}
\parindent=12pt
{\color{color18} \textbf{(}}0 {\color{color18} \textbf{\texttt{<}}} auth\_in{\color{color18} \textbf{.}}rloi 
{\color{color18} \textbf{and}} auth\_in{\color{color18} \textbf{.}}rloi {\color{color18} \textbf{\texttt{<}=}} 
5 {\color{color18} \textbf{and     }}

\parindent=18pt
0 {\color{color18} \textbf{\texttt{<}=}} auth\_in{\color{color18} \textbf{.}}csm 
{\color{color18} \textbf{and}} auth\_in{\color{color18} \textbf{.}}csm {\color{color18} \textbf{\texttt{<}=}} 
2 {\color{color18} \textbf{and}}      

0 {\color{color18} \textbf{\texttt{<}}} auth\_in{\color{color18} \textbf{.}}cucsid 
{\color{color18} \textbf{and}} auth\_in{\color{color18} \textbf{.}}cucsid {\color{color18} \textbf{\texttt{<}}} 
255 {\color{color18} \textbf{and     }}

\parindent=0pt
{\color{color17} -{}-right now we model just two control stations      }

\parindent=18pt
0 {\color{color18} \textbf{\texttt{<}=}} auth\_in{\color{color18} \textbf{.}}cs 
{\color{color18} \textbf{and}} auth\_in{\color{color18} \textbf{.}}cs {\color{color18} \textbf{\texttt{<}=}} 
1{\color{color18} \textbf{);}}

}%
}
\caption{Part 5 of the contract for the LOI Manager}
\label{fig:loi-contract5}
\end{figure}